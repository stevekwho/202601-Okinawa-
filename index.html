<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 Ê≤ñÁπ©‰πãÊóÖ (Final)</title>
    <!-- ÂºïÂÖ• Noto Sans TC Ëàá Roboto Â≠óÈ´î -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Êó•Á≥ªÁ∞°Á¥ÑÈÖçËâ≤ (V2) */
            --bg-color: #F9F9F7;       
            --card-bg: #FFFFFF;        
            --primary: #5B8996;        
            --accent: #E07A5F;         
            --text-main: #4A4A4A;      
            --text-sub: #888888;       
            --border: #EAEAEA;         
            
            --tag-transport: #E3F2FD; --text-transport: #1976D2;
            --tag-food: #FFF3E0;     --text-food: #F57C00;
            --tag-spot: #E8F5E9;     --text-spot: #388E3C;
            --tag-hotel: #F3E5F5;    --text-hotel: #7B1FA2;
            --tag-shop: #FFF8E1;     --text-shop: #FFA000;
            --tag-flight: #2C3E50;   --text-flight: #FFFFFF;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding-bottom: 90px;
            overflow-x: hidden;
        }

        /* Hero Section (V2) */
        .hero-header {
            position: relative; height: 250px; background-color: #5B8996;
            overflow: hidden; display: flex; flex-direction: column;
            justify-content: flex-end; padding: 25px; color: white;
        }
        .hero-header::before {
            content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background-image: url('https://images.unsplash.com/photo-1647336963732-7446b9da7a6f?q=80&w=2340');
            background-size: cover; background-position: center 60%; z-index: 1;
        }
        .hero-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0) 20%, rgba(0,0,0,0.6) 100%); z-index: 2;
        }
        .hero-content { position: relative; z-index: 3; }
        .hero-title { font-size: 26px; font-weight: 700; margin: 0; text-shadow: 0 2px 4px rgba(0,0,0,0.3); letter-spacing: 2px; }
        .hero-subtitle { font-size: 14px; opacity: 0.9; margin-top: 5px; font-weight: 300; }
        
        .countdown-box {
            position: absolute; top: 20px; right: 20px;
            background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px);
            padding: 10px 15px; border-radius: 12px; text-align: center;
            border: 1px solid rgba(255,255,255,0.2); z-index: 10;
        }
        .countdown-num { font-size: 20px; font-weight: bold; line-height: 1; }
        .countdown-label { font-size: 10px; opacity: 0.9; margin-top: 2px; }

        .container { max-width: 600px; margin: 0 auto; padding: 0 15px; }

        /* Day Nav (V2) */
        .day-nav-container {
            position: sticky; top: 0; background: rgba(249, 249, 247, 0.95);
            backdrop-filter: blur(10px); z-index: 50; padding: 12px 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .day-nav { display: flex; overflow-x: auto; padding: 0 15px; gap: 12px; scrollbar-width: none; }
        .day-nav::-webkit-scrollbar { display: none; }
        .day-btn {
            flex: 0 0 auto; min-width: 60px; height: 65px;
            border-radius: 16px; background: white; border: 1px solid var(--border);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; transition: all 0.3s; color: var(--text-sub);
        }
        .day-btn.active {
            background: var(--primary); color: white; border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(91, 137, 150, 0.3); transform: translateY(-2px);
        }
        .day-btn span:first-child { font-size: 13px; font-weight: bold; }
        .day-btn span:last-child { font-size: 10px; opacity: 0.8; }

        /* Weather Card (V2 Enhanced) */
        .weather-card {
            background: var(--card-bg); border-radius: 16px; padding: 18px 20px;
            margin: 20px 0; display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.03); border: 1px solid var(--border);
        }

        /* Timeline */
        .timeline { position: relative; padding-left: 20px; margin-top: 10px; }
        .timeline::before {
            content: ''; position: absolute; top: 15px; bottom: 30px; left: 26px;
            width: 2px; background: #E8E8E8; z-index: 0;
        }

        .event-group { position: relative; margin-bottom: 25px; z-index: 5; display: flex; gap: 15px; }
        .time-col {
            flex: 0 0 58px; text-align: right; padding-top: 10px;
            position: relative; z-index: 10; background: var(--bg-color);
        }
        .time-start { font-size: 14px; font-weight: 700; color: var(--text-main); font-family: 'Roboto', sans-serif; }
        .time-dur { font-size: 10px; color: var(--text-sub); display: block; margin-top: 2px; }

        .event-card {
            flex: 1; background: var(--card-bg); border-radius: 16px; padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.02); border: 1px solid var(--border); position: relative;
            transition: transform 0.2s;
        }

        /* V3 Clickable Style */
        .event-card.clickable { cursor: pointer; border-left: 4px solid var(--accent); }
        .event-card.clickable:active { transform: scale(0.98); background: #fafafa; }
        .click-hint {
            font-size: 11px; color: var(--accent); background: rgba(224, 122, 95, 0.1);
            padding: 4px 8px; border-radius: 4px; display: inline-block;
            margin-top: 8px; font-weight: 500;
        }

        /* Ticket Card (V2 Style) */
        .ticket-card {
            flex: 1; background: var(--tag-flight); color: white;
            border-radius: 16px; padding: 0; overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); position: relative;
        }
        .ticket-header {
            background: rgba(255,255,255,0.1); padding: 8px 15px; font-size: 13px; /* ÊîæÂ§ßÂ≠óÈ´î */
            display: flex; justify-content: space-between; letter-spacing: 1px;
            border-bottom: 1px dashed rgba(255,255,255,0.2);
        }
        .ticket-body { padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .ticket-point { text-align: center; }
        .ticket-time { font-size: 22px; font-weight: bold; font-family: 'Roboto', sans-serif; }
        .ticket-city { font-size: 12px; opacity: 0.8; margin-top: 2px; }
        .ticket-arrow { flex: 1; text-align: center; position: relative; padding: 0 10px; }
        .ticket-arrow::after { content: '‚úà'; font-size: 16px; }
        .ticket-footer {
            padding: 10px 15px; background: white; color: var(--text-main);
            font-size: 12px; display: flex; align-items: center; gap: 8px;
        }

        /* Transport Spacer (V2) */
        .transport-spacer { margin: -15px 0 15px 73px; position: relative; padding-left: 15px; }
        .transport-line {
            position: absolute; left: -47px; top: 0; bottom: 0; width: 2px;
            background: repeating-linear-gradient(to bottom, #E8E8E8, #E8E8E8 4px, transparent 4px, transparent 8px);
        }
        .transport-tag {
            background: #F0F0F0; color: var(--text-sub); font-size: 11px;
            padding: 4px 12px; border-radius: 20px; display: inline-flex;
            align-items: center; gap: 5px; border: 1px solid var(--border);
        }

        .event-group::before {
            content: ''; position: absolute; left: 23px; top: 17px; width: 8px; height: 8px;
            border-radius: 50%; background: white; border: 2px solid var(--primary); z-index: 2;
        }

        .tag { font-size: 10px; padding: 2px 8px; border-radius: 6px; display: inline-block; margin-bottom: 8px; font-weight: 600; }
        .evt-title { font-size: 15px; font-weight: bold; margin-bottom: 6px; line-height: 1.4; color: var(--text-main); }
        .evt-desc { font-size: 13px; color: #666; line-height: 1.5; margin-bottom: 10px; }
        
        /* Action Buttons (Restored V2 Styles) */
        .map-btn, .pdf-btn, .reservation-btn {
            display: inline-flex; align-items: center; gap: 4px; font-size: 12px;
            color: var(--primary); text-decoration: none; background: rgba(91, 137, 150, 0.1);
            padding: 6px 12px; border-radius: 20px; font-weight: 500; margin-right: 8px; margin-top: 5px;
        }
        .pdf-btn { color: #D32F2F; background: rgba(211, 47, 47, 0.1); }
        .reservation-btn { color: #E07A5F; background: rgba(224, 122, 95, 0.1); }

        /* V3 Modal */
        .modal {
            display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.5); backdrop-filter: blur(5px);
            align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s;
        }
        .modal.show { display: flex; opacity: 1; }
        .modal-content {
            background-color: #fff; margin: 15px; padding: 0; border-radius: 20px;
            width: 100%; max-width: 500px; max-height: 85vh; overflow-y: auto;
            position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.2); animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .modal-header {
            padding: 20px; border-bottom: 1px solid #eee; position: sticky; top: 0;
            background: white; z-index: 10; display: flex; justify-content: space-between; align-items: center;
        }
        .modal-title { font-size: 18px; font-weight: bold; color: var(--primary); }
        .close-btn { color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer; line-height: 1; }
        .modal-body { padding: 20px; }
        .option-item { border: 1px solid #eee; border-radius: 12px; padding: 15px; margin-bottom: 15px; background: #fafafa; }
        .opt-name { font-size: 16px; font-weight: bold; margin-bottom: 5px; display: flex; justify-content: space-between; }
        .opt-desc { font-size: 13px; color: #666; margin-bottom: 8px; line-height: 1.4; }
        .opt-rec { font-size: 12px; color: var(--primary); background: rgba(91,137,150,0.1); padding: 5px 10px; border-radius: 6px; display: inline-block; }

        /* Bottom Nav */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; right: 0; background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px); border-top: 1px solid rgba(0,0,0,0.05);
            display: flex; padding: 10px 0 25px 0; z-index: 1000;
        }
        .nav-item { flex: 1; text-align: center; cursor: pointer; color: #C0C0C0; }
        .nav-item.active { color: var(--primary); }
        .nav-icon { font-size: 24px; display: block; margin-bottom: 4px; } /* ÊîæÂ§ßÂúñÊ®ô */
        .nav-label { font-size: 12px; font-weight: 500; } /* ÊîæÂ§ßÂ≠óÈ´î */

        .list-header { display: flex; background: #F0F0F0; padding: 5px; border-radius: 12px; margin-bottom: 20px; }
        .list-tab { flex: 1; text-align: center; padding: 8px; font-size: 13px; border-radius: 8px; color: var(--text-sub); cursor: pointer; }
        .list-tab.active { background: white; color: var(--text-main); font-weight: bold; }
        
        .todo-item { background: white; padding: 15px; border-radius: 12px; margin-bottom: 10px; display: flex; align-items: center; gap: 12px; border: 1px solid var(--border); }
        .todo-item.checked { opacity: 0.6; background: #fbfbfb; }
        .todo-item.checked .todo-text { text-decoration: line-through; }
        
        /* Special styles for Shop items with price/loc */
        .shop-item-content { flex: 1; }
        .shop-header { display: flex; justify-content: space-between; margin-bottom: 4px; }
        .shop-name { font-size: 15px; font-weight: bold; color: var(--text-main); }
        .shop-price { font-size: 13px; color: var(--accent); font-weight: bold; }
        .shop-loc { font-size: 11px; color: var(--text-sub); background: #f0f0f0; padding: 2px 6px; border-radius: 4px; display: inline-block; }

        input[type="checkbox"] { width: 20px; height: 20px; accent-color: var(--accent); margin-right: 12px; }
        .todo-text { font-size: 14px; flex: 1; }
        .hidden { display: none; }

        /* New Add/Delete for Pre List */
        .add-item-container { margin: 20px 0; display: flex; gap: 10px; }
        #new-pre-item { flex: 1; padding: 10px; border: 1px solid var(--border); border-radius: 8px; font-size: 14px; }
        .add-btn { padding: 10px 20px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; }
        .delete-btn { cursor: pointer; color: #D32F2F; font-size: 18px; }
    </style>
</head>
<body>

<div id="page-itinerary">
    <div class="hero-header">
        <div class="hero-overlay"></div>
        <div class="countdown-box">
            <div id="countdown-num" class="countdown-num">--</div>
            <div class="countdown-label">DAYS LEFT</div>
        </div>
        <div class="hero-content">
            <h1 class="hero-title">Ê≤ñÁ∏Ñ„ÅÆÊóÖ 2026</h1>
            <p class="hero-subtitle">1Êúà1Êó• - 1Êúà6Êó• ‚Ä¢ 6Êó•Ëá™ÈßïË°åÁ®ã</p>
        </div>
    </div>

    <div class="day-nav-container">
        <div class="day-nav" id="day-nav-wrapper"></div>
    </div>

    <div class="container">
        <!-- Â§©Ê∞£Âç°Áâá -->
        <div class="weather-card">
            <div class="w-info">
                <h3 id="w-loc">ËÆÄÂèñÂ§©Ê∞£‰∏≠...</h3>
                <p id="w-desc">--</p>
            </div>
            <div style="text-align: right; display: flex; align-items: center; gap: 10px;">
                <div id="w-icon" style="font-size: 30px;">‚õÖ</div>
                <div>
                    <div id="w-temp" style="font-size: 24px; font-weight: bold; color: var(--primary);">--¬∞</div>
                    <div style="font-size: 12px; color: var(--accent);">‚òî <span id="w-rain">--%</span></div>
                </div>
            </div>
        </div>

        <div id="itinerary-content" class="timeline"></div>
    </div>
</div>

<!-- Ê∏ÖÂñÆÈ†ÅÈù¢ -->
<div id="page-list" class="container hidden" style="padding-top: 40px;">
    <h2 style="margin-bottom: 20px; font-weight: 700;">ÊóÖË°åÊ∏ÖÂñÆ</h2>
    <div class="list-header">
        <div class="list-tab active" onclick="switchListTab('pre')">Âá∫ÁôºÂâç</div>
        <div class="list-tab" onclick="switchListTab('shop')">ÂøÖË≤∑Ê∏ÖÂñÆ</div>
        <div class="list-tab" onclick="switchListTab('food')">ÂøÖÂêÉÁæéÈ£ü</div>
    </div>
    <div id="list-content"></div>
</div>

<!-- Â∫ïÈÉ®Â∞éËà™ -->
<nav class="bottom-nav">
    <div class="nav-item active" onclick="switchPage('itinerary')" id="nav-itinerary">
        <span class="nav-icon">üó∫Ô∏è</span>
        <span class="nav-label">Ë°åÁ®ã</span>
    </div>
    <div class="nav-item" onclick="switchPage('list')" id="nav-list">
        <span class="nav-icon">üìã</span>
        <span class="nav-label">Ê∏ÖÂñÆ</span>
    </div>
</nav>

<!-- Modal (V3) -->
<div id="option-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <span class="modal-title"></span>
            <span class="close-btn" onclick="closeModal()">&times;</span>
        </div>
        <div class="modal-body" id="modal-body"></div>
    </div>
</div>

<script>
    const itineraryData = {
        1: {
            date: "1/1 (ÈÄ±Âõõ)",
            events: [
                { time: "13:10", endTime: "16:40", dur: "3.5hr", type: "flight", title: "FD 518", desc: "HKG -> OKA", loc: "ÈÇ£Èú∏Ê©üÂ†¥" },
                { transport: "15mins Êé•ÈÄÅ", icon: "üöê" },
                { time: "17:30", dur: "30min", type: "transport", title: "ÂèñËªä", desc: "OkiBlues ‰∏≠ÊñáÁßüËªäÂÖ¨Âè∏", loc: "Oki Blues ‰∏≠ÊñáÁßüËªäÂÖ¨Âè∏" },
                { transport: "1hr ÈßïËªäËá≥ÂåóË∞∑", icon: "üöó" },
                { time: "19:00", dur: "30min", type: "hotel", title: "ÈÖíÂ∫ó Check-in", desc: "LeQu Okinawa Chatan Spa & Resort", loc: "LeQu Okinawa Chatan Spa & Resort", pdf: "lequ_booking_confirmation.pdf" },
                { transport: "5min Ê≠•Ë°å", icon: "üö∂" },
                { time: "19:30", dur: "1.5hr", type: "spot", title: "ÂåóË∞∑Áî∫ËßÄÂÖâ", desc: "ÁæéÂúãÊùëÊòØÊ≤ñÁπ©ÊúÄÂ§ßÁöÑÁæéÂúãÈ¢®ÊÉÖË≥ºÁâ©ÂçÄÔºåÂÖÖÊªøÁâπËâ≤ÂïÜÂ∫ó„ÄÅÈ§êÂª≥ÂíåInstagramÊâìÂç°ÈªûÔºåÈÅ©ÂêàÊº´Ê≠•ÂíåÊãçÁÖß„ÄÇ", loc: "ÁæéÂúãÊùë" },
                { time: "21:00", dur: "1.5hr", type: "food", title: "ÊôöÈ§ê: ÁêâÁêÉ‰πãÁâõ", desc: "ÂåóË∞∑Â∫ó (Â∑≤È†êÁ¥Ñ)", loc: "ÁêâÁêÉ‰πãÁâõ ÂåóË∞∑Â∫ó", reservation_url: "https://www.tablecheck.com/zh-TW/reservations/3NPHLW" },
                { time: "22:30", dur: "", type: "hotel", title: "ËøîÂõûÈÖíÂ∫ó", desc: "LeQu Okinawa Chatan Spa & Resort", loc: "" }
            ]
        },
        2: {
            date: "1/2 (ÈÄ±‰∫î)",
            events: [
                { time: "08:30", dur: "1hr", type: "food", title: "ÈÖíÂ∫óÊó©È§ê", desc: "", loc: "" },
                { transport: "40min ÈßïËªä", icon: "üöó" },
                { time: "10:30", dur: "45min", type: "spot", title: "Ëê¨Â∫ßÊØõ", desc: "Ë±°ÈºªÁãÄÊá∏Â¥ñ‰º∏ÂÖ•Êù±‰∏≠ÂúãÊµ∑Ôºå20Á±≥È´òÁêâÁêÉÁü≥ÁÅ∞Â≤©ÁµïÊôØÔºåÊèê‰æõÂ£ØÈ∫óÊµ∑ÊôØÂíåÊó•ËêΩËßÄË≥û„ÄÇ", loc: "Ëê¨Â∫ßÊØõ" },
                { transport: "30min ÈßïËªä", icon: "üöó" },
                { time: "11:45", dur: "15min", type: "food", title: "Ë®±Áî∞‰ºëÊÅØÁ´ô", desc: "ÈÅì‰πãÈ©õË®±Áî∞ÔºöÂçäÁÜü‰π≥ÈÖ™ËõãÁ≥ï„ÄÅÂ∏É‰∏Å", loc: "Ë®±Áî∞‰ºëÊÅØÁ´ô" },
                { transport: "40min ÈßïËªä", icon: "üöó" },
                { time: "12:40", dur: "2.5hr", type: "spot", title: "Âè§ÂÆáÂà©Â≥∂ & ÂçàÈ§ê", desc: "Â∞èÂ≥∂ÊìÅÊúâÁ¥∞Ê≤ôÊµ∑ÁÅò„ÄÅÂøÉÂΩ¢Â≤©Áü≥ÂíåÂ§ßÊ©ãÁæéÊôØÔºåÂÖÖÊªøÊ≤ñÁπ©‰∫ûÁï∂Â§èÂ®ÉÂÇ≥Ë™™ÔºåÈÅ©ÂêàÈßïËªäÊé¢Á¥¢Âíå‰∫´Áî®Ëù¶Ëù¶È£Ø„ÄÇ", loc: "Âè§ÂÆáÂà©Â≥∂" },
                { transport: "45min ÈßïËªä", icon: "üöó" },
                { time: "16:00", dur: "2.5hr", type: "spot", title: "ÁæéÈ∫óÊµ∑Ê∞¥ÊóèÈ§®", desc: "‰∏ñÁïåÊúÄÂ§ßÁ¥öÈªëÊΩÆ‰πãÊµ∑Ê∞¥ÊßΩÔºåÂ±ïÁ§∫Ê≤ñÁπ©Á•ûÁßòÊµ∑Ê¥ãÁîüÁâ©ÔºåÂåÖÊã¨ÈØ®ÈØäÂíåÈ≠îÈ¨ºÈ≠öÔºà4ÈªûÂæåÊòüÂÖâÁ•®ÂÉπÔºâ„ÄÇ", loc: "ÁæéÈ∫óÊµ∑Ê∞¥ÊóèÈ§®" },
		{ transport: "1hr15min ÈßïËªä", icon: "üöó" },
		{ time: "20:00", dur: "1.5hr", type: "food", title: "ÊôöÈ§ê:ÂåóË∞∑Áî∫", desc: "Taco Rice Cafe Kijimuna Depot Island / „Ç∞„É´„É°Ëø¥ËΩâÂ£ΩÂè∏Â∏ÇÂ†¥", loc: "American Village" },
		{ time: "21:30", dur: "", type: "hotel", title: "ËøîÂõûÈÖíÂ∫ó", desc: "LeQu Okinawa Chatan Spa & Resort", loc: "" }
            ]
        },
        3: {
            date: "1/3 (ÈÄ±ÂÖ≠)",
            events: [
                { time: "09:00", dur: "1hr", type: "food", title: "ÈÖíÂ∫óÊó©È§ê", desc: "", loc: "" },
                { time: "10:00", dur: "1hr", type: "spot", title: "ÂåóË∞∑Áî∫ÈñíÈÄõ", desc: "Êô®ÈñìÁæéÂúãÊùëÔºåÊ≤ñÁπ©ÊúÄÂ§ßÁöÑÁæéÂúãÈ¢®ÊÉÖË≥ºÁâ©ÂçÄÔºåÂÖÖÊªøÁâπËâ≤ÂïÜÂ∫ó„ÄÅÈ§êÂª≥ÂíåInstagramÊâìÂç°Èªû„ÄÇ", loc: "ÁæéÂúãÊùë" },
                { transport: "20min ÈßïËªä", icon: "üöó" },
                { time: "11:30", dur: "1.5hr", type: "food", title: "ÂçàÈ§ê: nankuru796", desc: "Á©∂Ê•µÊ≤ñÁπ©È∫µ", loc: "Ê≤ñÁ∏Ñ„Åù„Å∞ „Éä„É≥„ÇØ„É´796" },
                { transport: "20min ÈßïËªä", icon: "üöó" },
                { time: "13:15", dur: "5.5hr", type: "shop", title: "Aeon Mall Rycom", desc: "Ê≤ñÁπ©ÊúÄÂ§ßË≥ºÁâ©‰∏≠ÂøÉ & Pokemon Store", loc: "Aeon Mall Okinawa Rycom" },
                { transport: "45min ÈßïËªä", icon: "üöó" },
                { time: "19:30", dur: "15min", type: "hotel", title: "ÈÖíÂ∫ó Check-in", desc: "La'gent Hotel Okinawa Naha", loc: "La'gent Hotel Okinawa Naha", pdf: "lagent_booking_confirmation.pdf" },
		{ transport: "10min Ê≠•Ë°å", icon: "üö∂" },
		{ time: "20:00", dur: "1.5hr", type: "food", title: "ÊôöÈ§ê:È£üÂΩ©ÈÖíÊàø", desc: "Ê≤ñÁπ©ÂøÖÂêÉÈòøÂè§Ë±¨Ê∂ÆÊ∂ÆÈçã", loc: "È£üÂΩ©ÈÖíÊàø", pdf: "Visa È£üÂΩ©ÈÖíÊàø booking.pdf" },
		{ time: "21:40", dur: "", type: "hotel", title: "ËøîÂõûÈÖíÂ∫ó", desc: "La'gent Hotel Okinawa Naha", loc: "" }

            ]
        },
        4: {
            date: "1/4 (ÈÄ±Êó•)",
            events: [
                { time: "09:00", dur: "1hr", type: "food", title: "Êó©È§ê: Á¨¨‰∏ÄÁâßÂøóÂÖ¨Ë®≠Â∏ÇÂ†¥", desc: "È´îÈ©óÂú®Âú∞È≠öÂ∏ÇÂ†¥Êó©È§ê", loc: "Á¨¨‰∏ÄÁâßÂøóÂÖ¨Ë®≠Â∏ÇÂ†¥" },
                { transport: "20min ÈßïËªä", icon: "üöó" },
                { time: "10:30", dur: "1hr", type: "spot", title: "È¶ñÈáåÂüé / Ë•ø‰æÜÈô¢", desc: "ÁêâÁêÉÁéãÂúãÂè§ÂüéÔºåËûçÂêà‰∏≠Êó•Âª∫ÁØâÔºåÂåÖÂê´ÈÅîÁ£®ÂØ∫ÂíåÈ¶ñÈáåÂüéÂÖ¨ÂúíÔºåÈ´îÁèæÊ≤ñÁπ©Ê≠∑Âè≤ÊñáÂåñ„ÄÇ", loc: "È¶ñÈáåÂüé" },
                { transport: "10min ÈßïËªä", icon: "üöó" },
                { time: "11:40", dur: "1.5hr", type: "food", title: "ÂçàÈ§ê: Âè§Ê∞ëÂÆ∂È£üÂ†Ç", desc: "ÂÇ≥Áµ±Ê∞ëÊàø‰∫´Áî®ÁÇ∏Ë±¨Êéí", loc: "Âè§Ê∞ëÂÆ∂È£üÂ†Ç" },
                { transport: "30min ÈßïËªä", icon: "üöó" },
                { time: "13:30", dur: "2.5hr", type: "spot", title: "Ê≤ñÁπ©‰∏ñÁïå ÊñáÂåñÁéãÂúã", desc: "Ê≤ñÁπ©ÊñáÂåñ‰∏ªÈ°åÂÖ¨ÂúíÔºåÂåÖÊã¨ÁéâÊ≥âÊ¥ûÈêò‰π≥Áü≥Ê¥û„ÄÅÊâãÂ∑•ËóùÊùëÂíåËõáÂçöÁâ©È§®ÔºåÈ´îÈ©óÂÇ≥Áµ±ÊñáÂåñÂíåÂ§™ÈºìË°®Êºî„ÄÇ", loc: "Ê≤ñÁπ©‰∏ñÁïå" },
                { transport: "45min ÈßïËªä", icon: "üöó" },
                { time: "16:45", dur: "", type: "hotel", title: "ËøîÂõûÈÖíÂ∫óÂ∞è‰ºë", desc: "La'gent Hotel Okinawa Naha", loc: "" },
		{ transport: "10min Ê≠•Ë°å", icon: "üö∂" },
		{ time: "17:00", dur: "3.5hr", type: "spot", title: "ÂúãÈöõÈÄöÊôöÈ§ê & ÈÄõË°ó", desc: "ÈÇ£Èú∏‰∏ªË¶ÅË≥ºÁâ©Ë°óÔºåÈï∑1.6ÂÖ¨ÈáåÔºåÂÖÖÊªøÂïÜÂ∫ó„ÄÅÈ§êÂª≥ÂíåË°óÈ†≠Ë°®ÊºîÔºåÈÅ©ÂêàÊôöÈ§êÂíåÈÄõË°óÔºàÂ±ãÂè∞ÊàñÁâõÊéíÔºâ„ÄÇ", loc: "ÂúãÈöõÈÄö" },
		{ transport: "10min Ê≠•Ë°å", icon: "üö∂" },
		{ time: "21:10", dur: "", type: "hotel", title: "ËøîÂõûÈÖíÂ∫ó", desc: "La'gent Hotel Okinawa Naha", loc: ""}
            ]
        },
        5: {
            date: "1/5 (ÈÄ±‰∏Ä)",
            events: [
                { time: "10:15", dur: "45min", type: "spot", title: "Ê≥¢‰∏äÂÆÆ", desc: "Êá∏Â¥ñ‰∏äÁöÑÁ•ûÁ§æÔºå‰øØÁû∞ÈÇ£Èú∏Êµ∑ÁÅòÂíåÊµ∑Ê¥ãÔºåÁêâÁêÉÁ•ûÈÅìËÅñÂú∞ÔºåÈÅ©ÂêàÂèÉÊãúÂíåÊ¨£Ë≥ûÊµ∑ÊôØ„ÄÇ", loc: "Ê≥¢‰∏äÂÆÆ" },
                { transport: "30min ÈßïËªä", icon: "üöó" },
                { time: "11:30", dur: "1.5hr", type: "food", title: "ÂçàÈ§ê: ÊöñÊöÆÊãâÈ∫µ", desc: "Á≥ªÊªøÂ∫ó", loc: "ÊöñÊöÆÊãâÈ∫µ Á≥ªÊªøÂ∫ó" },
                { transport: "10min ÈßïËªä", icon: "üöó" },
                { time: "13:10", dur: "5hr", type: "shop", title: "Ashibinaa Outlet", desc: "ÂìÅÁâåÊäòÊâ£Ë≥ºÁâ©‰∏≠ÂøÉ", loc: "Ashibinaa Outlet" },
                { transport: "40min ÈßïËªä", icon: "üöó" },
		{ time: "18:55", dur: "", type: "hotel", title: "ËøîÂõûÈÖíÂ∫óÂ∞è‰ºë", desc: "La'gent Hotel Okinawa Naha", loc: "" },
		{ transport: "5min Ê≠•Ë°å", icon: "üö∂" },
                { time: "19:00", dur: "2hr", type: "food", title: "ÊôöÈ§ê: ÁáíËÇâ„Åì„Åì„Åã„Çâ", desc: "ÈÇ£Èú∏‰πÖËåÇÂú∞Â∫ó ÂéöÂàáÁâõËàå", loc: "ÁáíËÇâ„Åì„Åì„Åã„Çâ ÈÇ£Èú∏‰πÖËåÇÂú∞Â∫ó" },
		{ time: "21:10", dur: "", type: "hotel", title: "ËøîÂõûÈÖíÂ∫ó", desc: "La'gent Hotel Okinawa Naha", loc: ""}
            ]
        },
        6: {
            date: "1/6 (ÈÄ±‰∫å)",
            events: [
                { time: "10:00", dur: "", type: "hotel", title: "Check-out", desc: "ÈÄÄÊàøÊ∫ñÂÇô", loc: "" },
                { transport: "40min ÈßïËªä", icon: "üöó" },
                { time: "11:00", dur: "3.5hr", type: "spot", title: "ÁÄ®Èï∑Â≥∂ Umikaji Terrace", desc: "Â∏åËáòÈ¢®ÁôΩËâ≤Èú≤Âè∞ÂïÜÂúàÔºå‰øØÁû∞Ê©üÂ†¥ÂíåÊÖ∂ËâØÈñìÁæ§Â≥∂ÔºåÊèê‰æõË≥ºÁâ©„ÄÅÈ§êÈ£≤ÂíåÊó•ËêΩËßÄË≥ûÔºà‰∫´Áî®Âπ∏Á¶èÈ¨ÜÈ§ÖÔºâ„ÄÇ", loc: "ÁÄ®Èï∑Â≥∂" },
                { transport: "25min ÈßïËªä", icon: "üöó" },
                { time: "14:45", dur: "25min", type: "transport", title: "ÈÇÑËªäÊâãÁ∫å", desc: "OkiBlues Ê≤ñÁπ©‰∏≠ÊñáÁßüËªä", loc: "Oki Blues ‰∏≠ÊñáÁßüËªäÂÖ¨Âè∏" },
                { transport: "20min Êé•ÈßÅËá≥Ê©üÂ†¥", icon: "üöê" },
                { time: "17:40", endTime: "19:25", dur: "2.5hr", type: "flight", title: "FD 519", desc: "OKA -> HKG", loc: "ÈÇ£Èú∏Ê©üÂ†¥" }
            ]
        }
    };

    // V2: Âú∞ÈªûÂ∞çÊáâË°® (Áî®ÊñºÂ§©Ê∞£)
    const dayLocations = {
        1: { lat: 26.3200, lon: 127.7600, name: "ÂåóË∞∑Áî∫ Chatan" },
        2: { lat: 26.5914, lon: 127.9771, name: "ÂêçË≠∑Â∏Ç Nago" }, 
        3: { lat: 26.2124, lon: 127.6809, name: "ÈÇ£Èú∏Â∏Ç Naha" },
        4: { lat: 26.2124, lon: 127.6809, name: "ÈÇ£Èú∏Â∏Ç Naha" },
        5: { lat: 26.2124, lon: 127.6809, name: "ÈÇ£Èú∏Â∏Ç Naha" },
        6: { lat: 26.2124, lon: 127.6809, name: "ÈÇ£Èú∏Â∏Ç Naha" }
    };

    // Ê∏ÖÂñÆË≥áÊñô (Â∑≤Êõ¥Êñ∞: Shop ÁÇ∫Ë©≥Á¥∞Áâ©‰ª∂Ê†ºÂºè)
    const initialPreList = [
        "Passport (HK)", "Passport BNO", "HKID", "Cash", "Credit card", "Hotel booking confirmation", "Flight tickets", "Travel insurance documents",
        "SIM card", "Power bank", "Charging cables", "Power plug", "Travel adaptor",
        "Clothes", "Underwear", "Socks", "Sneakers", "Pajamas", "Bags", "Sunglasses", "Contact lenses",
        "Longchamp carry-on bag",
        "Toothpaste", "Toothbrush", "Shower gel", "Conditioner", "Face wash", "Body lotion", "Hand cream", "Eye drops",
        "Skincare products", "Makeup remover", "Face masks", "Sunscreen", "Perfume", "Cotton pads",
        "Umbrella", "Face masks", "Wet tissues", "Tissue paper", "Plastic bags", "Pens", "Comb",
        "Hair ties", "Sanitary napkins"
    ];

    const todoData = {
        pre: initialPreList,  // ÂàùÂßãÂæûPDF
        shop: [
            { name: "Panasonic ÂêπÈ¢®Ê©ü NA0J", loc: "Bic Camera / Kojima", price: "Á¥Ñ ¬•38,610" },
            { name: "ÂêàÂà©‰ªñÂëΩ EX Plus (270Èå†)", loc: "Â§ßÂúãËó•Â¶ù", price: "Á¥Ñ ¬•4,980" },
            { name: "Wakamoto Ëã•ÂÖÉÈå† (1000Èå†)", loc: "Â§ßÂúãËó•Â¶ù / ÊùæÊú¨Ê∏Ö", price: "Á¥Ñ ¬•1,680" },
            { name: "DHC Ë≠∑ÂîáËÜè", loc: "Â§ßÂúãËó•Â¶ù", price: "Á¥Ñ ¬•498" },
            { name: "ÈÇäÈäÄÈ£üÂ†Ç ËíúÂë≥Ëæ£Ê≤π", loc: "Ë∂ÖÂ∏Ç / È©öÂÆâÊÆøÂ†Ç", price: "Á¥Ñ ¬•1,000" },
            { name: "Ê≤ñÁπ©Á¥ÖËäãÂ°î (10ÂÖ•)", loc: "Âæ°ËèìÂ≠êÂæ°ÊÆø", price: "Á¥Ñ ¬•1,080" },
            { name: "Pokemon Center ÈôêÂÆöÁé©ÂÅ∂", loc: "Aeon Mall Rycom", price: "Á¥Ñ ¬•2,200" },
            { name: "Áü≥Âû£Â≥∂Ëæ£Ê≤π", loc: "ÂúãÈöõÈÄöÂúüÁî¢Â∫ó", price: "Á¥Ñ ¬•900" }
        ],
        food: ["Ê≤ñÁπ©È£ØÁ≥∞", "Blue Seal ÂÜ∞Ê∑áÊ∑ã", "ÈòøÂè§Ë±¨ÁÅ´Èçã", "Â°îÂèØÈ£Ø", "Êµ∑Ëë°ËêÑ", "Orion Âï§ÈÖí"]
    };

    const typeColors = {
        flight: "var(--tag-flight)", food: "var(--tag-food)", spot: "var(--tag-spot)", hotel: "var(--tag-hotel)", shop: "var(--tag-shop)", transport: "var(--tag-transport)", drive: "var(--tag-transport)"
    };

    let forecastData = null;
    const weatherIcons = {
        0: '‚òÄÔ∏è', 1: '‚òÄÔ∏è', 2: '‚õÖ', 3: '‚òÅÔ∏è', 45: 'üå´Ô∏è', 48: 'üå´Ô∏è', 51: 'üåßÔ∏è', 53: 'üåßÔ∏è', 55: 'üåßÔ∏è', 61: 'üå¶Ô∏è', 71: '‚ùÑÔ∏è', 95: '‚õàÔ∏è'
    };
    let currentDay = 1;

    function init() {
        loadPreList();  // Âä†ËºâËá™ÂÆöÁæ©preÂàóË°®
        renderDayNav();
        renderItinerary(1);
        renderList('pre');
        updateCountdown();
        fetchForecast(); 
    }

    // Âä†Ëºâ/‰øùÂ≠òpreÂàóË°®Âà∞localStorage
    function loadPreList() {
        const savedPre = localStorage.getItem('okinawa_pre_list');
        if (savedPre) {
            todoData.pre = JSON.parse(savedPre);
        } else {
            savePreList();
        }
    }

    function savePreList() {
        localStorage.setItem('okinawa_pre_list', JSON.stringify(todoData.pre));
    }

    // Ê∑ªÂä†È†ÖÁõÆ
    function addPreItem() {
        const input = document.getElementById('new-pre-item');
        const newItem = input.value.trim();
        if (newItem) {
            todoData.pre.push(newItem);
            savePreList();
            renderList('pre');
            input.value = '';
        }
    }

    // Âà™Èô§È†ÖÁõÆ
    function deletePreItem(index) {
        todoData.pre.splice(index, 1);
        savePreList();
        renderList('pre');
    }

    function renderDayNav() {
        const wrapper = document.getElementById('day-nav-wrapper');
        let html = '';
        Object.keys(itineraryData).forEach(day => {
            html += `<div class="day-btn ${day == 1 ? 'active' : ''}" onclick="switchDay(${day})"><span>Day ${day}</span><span>${itineraryData[day].date.split(' ')[0]}</span></div>`;
        });
        wrapper.innerHTML = html;
    }

    function renderItinerary(day) {
        currentDay = day;
        document.querySelectorAll('.day-btn').forEach((btn, idx) => btn.classList.toggle('active', (idx + 1) == day));
        const container = document.getElementById('itinerary-content');
        let html = '';
        
        itineraryData[day].events.forEach((evt, index) => {
            if (evt.transport) {
                html += `
                    <div class="transport-spacer">
                        <div class="transport-line"></div>
                        <div class="transport-tag">${evt.icon} ${evt.transport}</div>
                    </div>`;
            } else if (evt.type === 'flight') {
                // V2: Ê©üÁ•®Ê®£Âºè + Logo
                html += `
                    <div class="event-group">
                        <div class="time-col">
                            <span class="time-start">${evt.time}</span>
                            <span class="time-dur">${evt.dur}</span>
                        </div>
                        <div class="ticket-card">
                            <div class="ticket-header">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <img src="https://1000logos.net/wp-content/uploads/2020/04/AirAsia-Logo-2012.png" alt="AirAsia" style="height: 20px;">
                                    <span>Thai AirAsia</span>
                                </div>
                                <span>${evt.title}</span>
                            </div>
                            <div class="ticket-body">
                                <div class="ticket-point">
                                    <div class="ticket-time">${evt.time}</div>
                                    <div class="ticket-city">${evt.desc.split(' -> ')[0]}</div>
                                </div>
                                <div class="ticket-arrow"></div>
                                <div class="ticket-point">
                                    <div class="ticket-time">${evt.endTime}</div>
                                    <div class="ticket-city">${evt.desc.split(' -> ')[1]}</div>
                                </div>
                            </div>
                            <div class="ticket-footer">
                                üìç ÈÇ£Èú∏Ê©üÂ†¥ (OKA)
                            </div>
                        </div>
                    </div>`;
            } else {
                // V2 Buttons + V3 Options
                const hasOptions = evt.hasOptions;
                const clickAttr = hasOptions ? `onclick="openModal(${index})"` : '';
                const clickClass = hasOptions ? 'clickable' : '';
                
                // V2: PDF & Booking Links
                const mapLink = (!hasOptions && evt.loc) ? `<a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(evt.loc)}" target="_blank" class="map-btn">üìç Google Map</a>` : '';
                const pdfLink = evt.pdf ? `<a href="${evt.pdf}" target="_blank" class="pdf-btn">üìÑ Booking PDF</a>` : '';
                const reservationLink = evt.reservation_url ? `<a href="${evt.reservation_url}" target="_blank" class="reservation-btn">üìÖ È†êÁ¥ÑÁ¢∫Ë™ç</a>` : '';
                const optionHint = hasOptions ? `<div class="click-hint">üëá ÈªûÊìäÈÅ∏ÊìáÈ§êÂª≥</div>` : '';

                html += `
                    <div class="event-group">
                        <div class="time-col">
                            <span class="time-start">${evt.time}</span>
                            <span class="time-dur">${evt.dur}</span>
                        </div>
                        <div class="event-card ${clickClass}" ${clickAttr}>
                            <span class="tag" style="background:${typeColors[evt.type] || '#eee'}; color:${evt.type==='flight'?'#fff':'#333'}">${getTagLabel(evt.title, evt.type)}</span>
                            <div class="evt-title">${evt.title}</div>
                            <div class="evt-desc">${evt.desc}</div>
                            ${optionHint}
                            ${reservationLink}${pdfLink}${mapLink}
                        </div>
                    </div>`;
            }
        });
        container.innerHTML = html;
        window.scrollTo({ top: 0, behavior: 'smooth' });
        updateWeatherCard(day);
    }

    function openModal(eventIndex) {
        const evt = itineraryData[currentDay].events[eventIndex];
        if (!evt.hasOptions) return;
        document.getElementById('modal-title').innerText = evt.title;
        const body = document.getElementById('modal-body');
        
        let html = '';
        evt.options.forEach(opt => {
            html += `
                <div class="option-item">
                    <div class="opt-name">
                        ${opt.name}
                        ${opt.loc ? `<a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(opt.loc)}" target="_blank" style="text-decoration:none">üó∫Ô∏è</a>` : ''}
                    </div>
                    <div class="opt-desc">${opt.desc}</div>
                    ${opt.rec ? `<div class="opt-rec">üí° ${opt.rec}</div>` : ''}
                </div>`;
        });
        body.innerHTML = html;
        
        const modal = document.getElementById('option-modal');
        modal.style.display = "flex";
        setTimeout(() => modal.classList.add('show'), 10);
    }

    function closeModal() {
        const modal = document.getElementById('option-modal');
        modal.classList.remove('show');
        setTimeout(() => modal.style.display = "none", 300);
    }
    window.onclick = function(event) { if (event.target == document.getElementById('option-modal')) closeModal(); }

    function getTagLabel(title, type) {
        if (title.includes("ÂçàÈ§ê")) return "ÂçàÈ§ê";
        if (title.includes("ÊôöÈ§ê")) return "ÊôöÈ§ê";
        if (title.includes("Êó©È§ê")) return "Êó©È§ê";
        const map = { flight: "Ëà™Áè≠", transport: "‰∫§ÈÄö", drive: "ÈßïËªä", food: "ÁæéÈ£ü", spot: "ÊôØÈªû", hotel: "‰ΩèÂÆø", shop: "Ë≥ºÁâ©" };
        return map[type] || "ÂÖ∂‰ªñ";
    }

    function switchDay(day) { renderItinerary(day); }

    function renderList(tab) {
        document.querySelectorAll('.list-tab').forEach((el, idx) => el.classList.toggle('active', ['pre','shop','food'][idx] === tab));
        const container = document.getElementById('list-content');
        let html = '';
        
        if (tab === 'pre') {
            html += `
                <div class="add-item-container">
                    <input type="text" id="new-pre-item" placeholder="Ê∑ªÂä†Êñ∞È†ÖÁõÆ...">
                    <button class="add-btn" onclick="addPreItem()">Ê∑ªÂä†</button>
                </div>`;
        }
        
        html += todoData[tab].map((item, index) => {
            const id = `${tab}-${index}`;
            const checked = localStorage.getItem('okinawa_todo_' + id) === 'true';
            
            // ÁâπÂà•ËôïÁêÜ Shop ÁöÑË©≥Á¥∞È°ØÁ§∫
            let contentHtml = '';
            if (tab === 'shop' && typeof item === 'object') {
                contentHtml = `
                    <div class="shop-item-content">
                        <div class="shop-header">
                            <span class="shop-name">${item.name}</span>
                            <span class="shop-price">${item.price}</span>
                        </div>
                        <span class="shop-loc">üìç${item.loc}</span>
                    </div>`;
            } else {
                contentHtml = `<span class="todo-text">${item}</span>`;
            }

            let deleteBtn = (tab === 'pre') ? `<span class="delete-btn" onclick="deletePreItem(${index})">üóëÔ∏è</span>` : '';

            return `
                <label class="todo-item ${checked ? 'checked' : ''}" id="row-${id}">
                    <input type="checkbox" id="${id}" onchange="toggleCheck('${id}')" ${checked ? 'checked' : ''}>
                    ${contentHtml}
                    ${deleteBtn}
                </label>`;
        }).join('');

        container.innerHTML = html;
    }

    function switchListTab(tab) { renderList(tab); }

    function toggleCheck(id) {
        const cb = document.getElementById(id);
        const row = document.getElementById('row-' + id);
        row.classList.toggle('checked', cb.checked);
        localStorage.setItem('okinawa_todo_' + id, cb.checked);
    }

    function switchPage(page) {
        document.getElementById('page-itinerary').classList.toggle('hidden', page !== 'itinerary');
        document.getElementById('page-list').classList.toggle('hidden', page !== 'list');
        document.querySelectorAll('.nav-item').forEach(el => el.classList.toggle('active', el.id === 'nav-' + page));
        window.scrollTo(0,0);
    }

    function updateCountdown() {
        const diff = new Date("2026-01-01T00:00:00") - new Date();
        document.getElementById('countdown-num').innerText = Math.max(0, Math.ceil(diff / 86400000));
    }

    // V2 Âº∑ÂåñÁâàÂ§©Ê∞£ÈÇèËºØ
    async function fetchForecast() {
        try {
            // È†êË®≠ÊäìÈÇ£Èú∏Ôºå‰ΩÜÂ≠ò 14 Â§©
            const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=26.2124&longitude=127.6809&daily=temperature_2m_max,temperature_2m_min,weather_code,precipitation_probability_mean&timezone=Asia%2FTokyo&forecast_days=14');
            const data = await res.json();
            forecastData = data.daily;
            updateWeatherCard(1);
        } catch (e) { document.getElementById('w-loc').innerText = "Â§©Ê∞£Êö´ÊôÇÁÑ°Ê≥ïÈ°ØÁ§∫"; }
    }

    function updateWeatherCard(day) {
        if (!forecastData) return;
        const today = new Date();
        const tripStart = new Date('2026-01-01');
        const daysUntilTrip = Math.ceil((tripStart - today) / (1000 * 60 * 60 * 24));
        const forecastIndex = Math.max(0, daysUntilTrip + day - 1); 

        // ÂÆâÂÖ®Ê™¢Êü•
        if (forecastIndex >= forecastData.time.length) {
            document.getElementById('w-loc').innerText = "Â§™‰πÖÈÅ†ÁÑ°Ê≥ïÈ†êÊ∏¨";
            return;
        }

        const location = dayLocations[day] || { name: "ÈÇ£Èú∏Â∏Ç Naha" };
        const maxTemp = Math.round(forecastData.temperature_2m_max[forecastIndex]);
        const minTemp = Math.round(forecastData.temperature_2m_min[forecastIndex]);
        const code = forecastData.weather_code[forecastIndex];
        const precip = forecastData.precipitation_probability_mean[forecastIndex] || 0;

        document.getElementById('w-loc').innerText = location.name;
        document.getElementById('w-temp').innerText = `${maxTemp}¬∞ / ${minTemp}¬∞`;
        document.getElementById('w-rain').innerText = `${precip}%`;
        document.getElementById('w-desc').innerText = code < 3 ? "Êô¥Êúó" : code < 50 ? "Â§öÈõ≤" : "ÊúâÈõ®";
        document.getElementById('w-icon').innerText = weatherIcons[code] || '‚õÖ';
    }

    init();
</script>
</body>
</html>
